<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>BlueNRG-1,2 Development kits (STSW-BLUENRG1-DK): Release Notes 3.0.0 / 22-June-2018 (BlueNRG-BLE Stack Library v2.1)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="STcustom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BlueNRG-1,2 Development kits (STSW-BLUENRG1-DK)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Release Notes 3.0.0 / 22-June-2018 (BlueNRG-BLE Stack Library v2.1) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="S1"></a>
New Features/Changes</h1>
<p>This section lists the new features/changes compared to previous BlueNRG-1_2 DK release: <br />
</p>
<ul>
<li>Added support for <b>BlueNRG-BLE Stack Library</b> v2.1 with following main new features: <ul>
<li>
Qualified Bluetooth LE v.5.0 </li>
<li>
MISRA-C:2012 compliance </li>
<li>
Bluetooth LE Data Packet Length extension support: LL-PDU data payload up to 251 bytes (only for BlueNRG-2 devices) </li>
<li>
BLE stack modular configurations allowing to optimize BLE stack memory footprints based on user application scenario. </li>
</ul>
</li>
</ul>
<ul>
<li>Added configuration files stack_user_cfg.[c/h] allowing to enable BLE stack modular approach. The following BLE stack v2.1 modular configurations options are currently supported: <ol>
<li>
<b>BLE_STACK_CONFIGURATION=BLE_STACK_FULL_CONFIGURATION</b> &ndash;&gt; preprocessor option to be added on BLE user application IDE toolchain, for configuring the BLE stack with all supported modular features: <ul>
<li>
Controller Privacy is enabled </li>
<li>
LE Secure Connection is enabled </li>
<li>
Master role is enabled </li>
<li>
Data length extension is enabled (valid only for BlueNRG-2 devices) </li>
</ul>
</li>
<li>
<b>BLE_STACK_CONFIGURATION=BLE_STACK_BASIC_CONFIGURATION</b> &ndash;&gt; preprocessor option to be added on BLE user application IDE toolchain for configuring the BLE stack with the basic configuration options: <ul>
<li>
Controller Privacy is disabled </li>
<li>
LE Secure Connection is disabled </li>
<li>
Master role is disabled (only Peripheral/Slave role is supported) </li>
<li>
Data length extension is disabled </li>
</ul>
</li>
<li>
<b>BLE_STACK_CONFIGURATION=BLE_OTA_BASIC_CONFIGURATION</b> &ndash;&gt; preprocessor option to be added on BLE user application IDE toolchain for selecting the OTA Service support with Data length extension (valid only for BlueNRG-2 device) BlueNRG-2 device, BLE stack v2.1 with the OTA Service support with Data length extension: <ul>
<li>
Controller Privacy is disabled </li>
<li>
LE Secure Connections is disabled </li>
<li>
Master role is disabled (only Peripheral/Slave role is supported) </li>
<li>
Data length extension is enabled (only for BlueNRG-2 device) </li>
</ul>
</li>
</ol>
</li>
<li>NOTES: <ul>
<li>
Bluetooth LE Data Packet Length extension must be disabled on each configuration related to a BlueNRG-1 device (it doesn't support this feature). </li>
<li>
Files stack_user_cfg.[c/h] must not be modified by user. </li>
<li>
<b>BLE_STACK_CONFIGURATION=BLE_STACK_BASIC_CONFIGURATION</b> is the default option. If no value is defined for the preprocessor option BLE_STACK_CONFIGURATION on IDE toolchain, the BLE_STACK_BASIC_CONFIGURATION is selected. </li>
</ul>
</li>
</ul>
<ul>
<li>Updated BLE stack APIs and events interfaces for aligning to BLE stack v2.1 </li>
<li>Updated bluenrg1_stack.h defines values and macros for aligning to BLE stack v2.1 features. </li>
<li>Updated ble_status.h error codes for aligning to BLE stack v2.1 error codes (refer to available <a href="../BlueNRG1_BLE_stacks_migration/BlueNRG-1_2_BLE_stack_v2_1_Error_codes.xlsx">table</a> on <a href="../BlueNRG1_BLE_stacks_migration/ble__stacks__migration_8h.html">BLE stack migration guidelines from v1.x to v2.x and from v2.0 to v2.1 html documentation </a> </li>
<li>Improved aci_gap_get_oob_data() and aci_gap_set_oob_data() APIs and parameters description. </li>
<li>Updated Library\Bluetooth\ folder: it includes only the following BLE stack files: <ul>
<li>
inc\bluenrg1_api.h (BLE stack APIs header file) </li>
<li>
inc\bluenrg1_events.h (BLE stack events header file) </li>
<li>
inc\bluenrg1_stack.h (BLE stack initialization header file) </li>
<li>
inc\stack_user_cfg.h (BLE stack configuration header file for BLE stack modular framework support) </li>
<li>
inc\ble_status.h (BLE Stack status codes header file) </li>
<li>
library\libbluenrg1_stack.a (BLE stack binary file) </li>
<li>
src\stack_user_cfg.c (BLE stack configuration source file for for BLE stack modular framework support): <b>User must include this file on his BLE application project.</b> </li>
<li>
src\stack_dle_api_stubs.c, src\stack_priv_api_stubs.c, src\stack_sc_api_stubs.c, src\stack_slvonly_api_stubs.c stubs files to be used only with the DTM demonstration application </li>
</ul>
</li>
<li>Updated STM32L - BlueNRG-1,2 network coprocessor BLE stack APIs and events framework for aligning to BLE stack v2.1 </li>
<li>Added new folder BLE_Application on Library folder: it includes all the BLE applications header and sources files (BLE layers interfaces, utilities, OTA FW upgrade slave role procedure, central profiles framework). </li>
<li>Updated OTA_btl.[ch] framework for supporting BlueNRG-2 device, BLE stack v2.1 OTA FW upgrade with the BlueNRG-2 data length extension feature</li>
</ul>
<ul>
<li>Added new standalone <b>crypto library binary file</b> and header files interfaces for AES CMAC encryption/decryption on folder Library\cryptolib: <ul>
<li>
AES APIs are available for user applications requiring AES operations </li>
<li>
It also provides AES encryption APIs required by BLE stack v2.1 security framework </li>
<li>
<b>User must include this library on his BLE application project in order to have the required AES CMAC encryption functionality when needed by the BLE stack v2.1.</b></li>
</ul>
</li>
<li>Added BLEPLAT_get_part_info() API on Library\hal\src\miscutil.c file. </li>
<li>Added no retry feature on BLE stack v2.1 (capability to disable standard BLE automatic PDU acknowledgment on characteristics notifications)</li>
</ul>
<ul>
<li>Updated BLE examples configuration files: <ul>
<li>
Added stack_user_cfg.h header file inclusion </li>
<li>
Replaced PCKT_COUNT define with MBLOCKS_COUNT define </li>
<li>
Added CONTROLLER_DATA_LENGTH_EXTENSION_ENABLED to TOTAL_BUFFER_SIZE() macro parameters </li>
</ul>
</li>
<li>Updated BLE examples configuration files for aligning to BLE stack v2.1 framework </li>
<li>Updated BLE examples for using aci_gatt_update_char_value_ext() API </li>
<li>Added BLE OTA Reset and Service Manager demo applications supporting BlueNRG-1, BLE stack v2.1 (basic stack configuration) </li>
<li>Updated BlueNRG-1, BLE Sensor demo, Chat and Beacon applications with projects configurations supporting OTA FW upgrade: <ul>
<li>
On BlueNRG-1, BLE stack v2.1, OTA FW upgrade feature is supported only with applications built with basic stack configuration option. </li>
</ul>
</li>
<li>Added BlueNRG-2 Throughput demo application with data length extension and increased ATT_MTU size features (and related html documentation) </li>
<li>Updated BlueNRG-1 Chat and Chat Master and Slave demonstration applications </li>
<li>Updated DTM application to v3.0: <ul>
<li>
Aligned APIs and events to BLE stack v2.1 </li>
<li>
Added BOR and flash lock management </li>
<li>
Added stack_*_api_stubs files for preprly handling APIs when not defined as consequence of selected BLE stack modular configuration </li>
<li>
Added framework for properly setting the BTLE_Stack_variant parameter of aci_hal_get_firmware_details() API and returning the enabled BLE stack modular configuration </li>
<li>
Reviewed HCI_PACKET_SIZE value (259 bytes) </li>
<li>
Reviewed watchdog management </li>
</ul>
</li>
</ul>
<ul>
<li>Added support for BlueNRG-2 data length extension packets and multi state functionality to 2.4 GHz proprietary radio solution based on Radio Low Level driver (hal_radio.[c/h], BlueNRG1_radio.[c/h] files): <ul>
<li>
Up to 255 bytes can be sent on a single packet when using Radio Low Level driver on BlueNRG-2 </li>
</ul>
</li>
<li>Updated hal_radio.c APIs prototypes and implementation (refer to associated html documentation): <ul>
<li>
HAL_RADIO_SendPacket(): removed time_type parameter; renamed time parameter as wakeup_time. </li>
<li>
HAL_RADIO_SendPacketWithAck(): removed time_type parameter; renamed time parameter as wakeup_time. </li>
<li>
HAL_RADIO_ReceivePacket(): removed time_type and timestamp_type parameters; renamed time parameter as wakeup_time. </li>
<li>
HAL_RADIO_ReceivePacketWithAck(): removed time_type and timestamp_type parameters; renamed time parameter as wakeup_time. </li>
<li>
<b> IMPORTANT: When moving a 2.4 GHz proprietary radio application to SDK 3.0.0, user must align the hal_radio.c APIs calls to the new HAL radio APIs parameters</b> </li>
</ul>
</li>
<li>Added 2.4 GHz proprietary radio Over-the-Air FW upgrade framework support based on Radio Low Level driver (radio_ota.[c/h] files) </li>
<li>Added 2.4 GHz proprietary radio demonstration application showing the 2.4 GHz proprietary radio Over-the-Air FW upgrade support functionality (OTA_ResetManager project with Client, Server configurations) </li>
<li>Added new 2.4 GHz proprietary radio demonstration applications based on Radio Low Level driver multi state functionality (beep and sniffer demos) </li>
<li>Added new 2.4 GHz proprietary radio star network demonstration applications based on Radio Low Level driver</li>
</ul>
<ul>
<li>Updated BlueNRG1.h and BlueNRG2.h files (reviewed some registers and some registers description) </li>
<li>Updated system_BlueNRG1.h and system_BlueNRG2.h files </li>
<li>Updated system_BlueNRG1.c and sleep.[c/h] files: <ul>
<li>
Added BOR configuration management and enabling BOR by default; </li>
<li>
Added flash lock management for avoiding undesired FLASH operation during startup phase. </li>
</ul>
</li>
<li>Updated system_BlueNRG1.c file: added function for handling low speed oscillator stabilization procedure when using internal RO </li>
<li>Updated sleep.h file documentation </li>
<li>Added file <b>miscutil.c</b> on all SDK demonstrations applications (<b>user application must include it since it is required from system_BlueNRG1.c APIs</b>) </li>
<li>Updated context_switch.s file</li>
</ul>
<ul>
<li>Updated BlueNRG-1, BlueNRG-2 IAR, KEIL and Atollic linker files (<b>user application must include new linker files</b>) </li>
<li>Removed reference to libsmall_printf_atollic.a library from all Atollic projects</li>
</ul>
<ul>
<li>Updated BlueNRG1_adc.[c/h] ADC driver (Added APIs: ADC_Filter(); ADC_GetFlags(). Added macro for ADC 2411 issue workaround. Reviewed some APIs implementation with updated ADC formulas) </li>
<li>Updated BlueNRG1_flash.[c/h] Flash driver (Added APIs: FLASH_Lock(); FLASH_Unlock(). Updated APIs with check on flash_sw_lock variable to avoid undesired FLASH operations) </li>
<li>Updated BlueNRG1_gpio.[c/h] GPIO driver (Added APIs: GPIO_InitLowPowerModes(); GPIO_WriteBitLowPowerModes(); GPIO_GetITStatusBit(). Removed API: GPIO_SetRetentionState(). Updated GPIO_Init()) </li>
<li>Updated BlueNRG-1_mft.[c/h] timer driver (Added API: MFT_PulseTrainEventTriggerStatus(). Reviewed APIs, parameters comments) </li>
<li>Updated BlueNRG1_wdg.[c/h] watchdog driver (Added API: WDG_DisableReset(). Added comments about how to use watchdog functionality) </li>
<li>Updated SDK_Eval_Com.c file: reviewed SdkEvalComIOConfig(), __read(), __io_getcharNonBlocking(), fgetc() APIs </li>
<li>Updated gp_timer.[ch] and clock.c files</li>
</ul>
<ul>
<li>Updated <a href="../BlueNRG1_BLE_stacks_migration/ble__stacks__migration_8h.html">BLE stack migration guidelines html document</a>: <ul>
<li>
Add reference to BLE stack v2.1 APIs, events and migration steps from v2.0 to v2.1; </li>
<li>
Add list of BLE stack v2.1 <a href="../BlueNRG1_BLE_stacks_migration/BlueNRG-1_2_BLE_stack_v2_1_Error_codes.xlsx">error codes</a> </li>
</ul>
</li>
<li>Updated BlueNRG-1,2 Key Resources html documentation (added section for 2.4 GHz proprietary radio examples) </li>
<li>Updated all SDK demontrastions applications main files for including the comments used for generating the associated html documentation</li>
</ul>
<ul>
<li>Added support for new BlueNRG-1, STEVAL-IDB007V2 platform and BlueNRG-2, STEVAL-IDB008V2 platform (updated associated demo examples html documentation) </li>
<li>Updated BlueNRG-1,2 development platforms USB to Serial DFU fw to version v1.8. </li>
<li>NOTES: <ul>
<li>
<b> Before using a STEVAL-IDB007Vx (x = 1,2) or STEVAL-IDB008Vx (x= 1,2) platform, please align the <a href="../USB-to-SERIAL_FW_upgrade_procedure/USB-to-SERIAL_FW_upgrade_procedure.html">USB to Serial DFU fw </a> to the latest available version (v1.8) </b>. </li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="S11"></a>
Navigator PC applications</h2>
<ul>
<li>
BlueNRG-1 Navigator 3.0.0 supporting BlueNRG-1 device. </li>
<li>
BlueNRG-2 Navigator 3.0.0 supporting BlueNRG-2 device.</li>
</ul>
<ul>
<li>Supported platforms: <ul>
<li>
BlueNRG-1, STEVAL-IDB007V1 development kit (order code: STEVAL-IDB007V1).  </li>
<li>
BlueNRG-1, STEVAL-IDB007V2 development kit (order code: STEVAL-IDB007V2).  </li>
<li>
BlueNRG-2, STEVAL-IDB008V1 development kit (order code: STEVAL-IDB008V1).  </li>
<li>
BlueNRG-2, STEVAL-IDB008V2 development kit (order code: STEVAL-IDB008V2). </li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="S12"></a>
Flasher PC application</h2>
<ul>
<li>Removed BlueNRG-1 Flasher Utility from BlueNRG-1_2 SDK 3.0.0: <ul>
<li>
New BlueNRG-1_2 Flasher PC utility supporting BlueNRG-1 and BlueNRG-2 devices (UART and SWD mode) is provided on a new standalone SW package <a href="http://www.st.com/content/st_com/en/products/embedded-software/wireless-connectivity-software/stsw-bnrgflasher.html">STSW-BNRGFLASHER</a> web page (GET SOFTWARE section).</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="S13"></a>
PC application/utilities (available on standalone SW packages)</h2>
<ul>
<li>Associated <a href="http://www.st.com/content/st_com/en/products/embedded-software/wireless-connectivity-software/stsw-bnrgui.html">STSW-BNRGUI</a>, BlueNRG GUI SW package is provided: it contains the BlueNRG GUI PC application and script launcher utility supporting BlueNRG-1, BlueNRG-2 devices. </li>
<li>BlueNRG current consumption estimation tool supporting BlueNRG-1 device is available on <a href="http://www.st.com/en/embedded-software/stsw-bnrg001.html">STSW-BNRG001</a> web page (GET SOFTWARE section).</li>
</ul>
<h2><a class="anchor" id="S14"></a>
Radio Parameters Wizard PC application</h2>
<ul>
<li>
BlueNRG-1 Radio Parameters Wizard 2.0.0 supporting BlueNRG-1, BlueNRG-2 devices and BLE stacks v2.0 and v2.1: <ul>
<li>
It allows to properly configure the BlueNRG_Stack_Initialization() API parameters in an user friendly way and to generate the related application *_config.h file to be used on user C application. </li>
<li>
Please refer to the following documents for more information about the BLE radio parameters to be configured: <ul>
<li>
BlueNRG-1,2 BLE Radio Parameters Wizard html documentation </li>
<li>
<a href="http://www.st.com/resource/en/programming_manual/dm00294449.pdf">BlueNRG-1,2 BLE stack programming guidelines (PM0257) </a> </li>
<li>
BLE stack v2.x Stack Memory Manager html documentation </li>
<li>
GATT database size guidelines html documentation</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="S2"></a>
Solved Issues</h1>
<p>This section lists the solved issues compared to previous BlueNRG-1_2 DK release: <br />
</p>
<ul>
<li>ID 3067 OTA FW upgrade is not supported on BlueNRG-1 BLE stack v2.0 due to the increased BLE stack v2.x memory footprint required for addressing BLE v4.2 LE secure connections and Privacy 1.2 features: <ul>
<li>
OTA FW upgrade is supported with BlueNRG-1 device with BLE stack v2.1 configured with the basic configuration (BLE_STACK_CONFIGURATION=BLE_STACK_BASIC_CONFIGURATION) </li>
</ul>
</li>
<li>ID 2485 BlueNRG-1_2 DK 2.6.0 - Atollic True Studio projects program and debug issue:<ul>
<li>
New SDK 3.0.0 updated BlueNRG1.ld, BlueNRG2.ld linker files solve the issue. </li>
</ul>
</li>
<li>ID 2433 BlueNRG-1 Radio transceiver: txcallbackwithack could be not called due to wakeup timer programmed with an old value. </li>
<li>ID 2437 DTM_Updater_Release building issue </li>
<li>ID 2430 OOB code example or documentation </li>
<li>ID 2404 SPI Timeout in BlueNRG-2 as Network Coprocessor </li>
<li>ID 2498 IO-12 irq flag is automatically set after configuring GPIO_EXTI and enabling EXTI </li>
<li>ID 2559 Missing BOR define on system_BlueNRG2.h </li>
<li>ID 2563 BlueNRG-2 GPIO-&gt;MODE2 and GPIO-&gt;MODE3 registers not restored on sleep.c</li>
</ul>
<h1><a class="anchor" id="S3"></a>
SW Package Contents</h1>
<ul>
<li>
BlueNRG-1,2 Bluetooth Low Energy (BLE) stack binary library and header files </li>
<li>
BlueNRG-1,2 Bluetooth Low Energy (BLE) network coprocessor (SPI and UART mode) reference application (DTM)  </li>
<li>
BlueNRG-1,2 Bluetooth Low Energy stack APIs and events callbacks html documentation </li>
<li>
BlueNRG-1,2 Master/Central library APIs and html documentation </li>
<li>
BlueNRG-1,2 Bluetooth Low Energy demonstration applications (header, sources and toolchains projects) + html documentation </li>
<li>
BlueNRG-1,2 Bluetooth Low Energy demonstration applications prebuilt images </li>
<li>
BlueNRG-1,2 CMSIS files </li>
<li>
BlueNRG-1,2 peripherals drivers + html documentation </li>
<li>
BlueNRG-1,2 peripherals drivers examples (header, sources and toolchains projects) + html documentation </li>
<li>
BlueNRG-1,2 peripherals drivers examples prebuilt images </li>
<li>
BlueNRG-1,2 SDK and HAL drivers + html documentation </li>
<li>
BlueNRG-1,2 network coprocessor SPI protocol specification html document  </li>
<li>
BlueNRG-1,2 GATT database size guidelines html documentation </li>
<li>
BlueNRG-1,2 Applications debugging guidelines html documentation </li>
<li>
BlueNRG-1,2 DK key resources html documentation </li>
<li>
Drivers for PC (USB Virtual COM) </li>
<li>
BlueNRG-1,2 Navigator PC applications:  <ul>
<li>
It provides an interactive, simple and user friendly interface to the resources available within the BlueNRG-1_2 DK SW package: <ul>
<li>
BlueNRG-1 Bluetooth Low Energy (BLE) Demonstration Applications </li>
<li>
BlueNRG-1 Peripherals Drivers Examples </li>
<li>
BlueNRG-1 Development Kits </li>
<li>
Release Notes </li>
<li>
License Files</li>
</ul>
</li>
</ul>
</li>
<li>
BlueNRG-1 Radio Parameters Wizard PC application <ul>
<li>
It allows the define the BlueNRG-1,2 radio initialization parameters. </li>
</ul>
</li>
<li>
STM32L - BlueNRG-1,2 network coprocessor setup and framework html documentation (SPI, UART) </li>
<li>
STM32L - BlueNRG-1,2 network coprocessor APIs/events html documentation </li>
</ul>
<h2><a class="anchor" id="S31"></a>
Bluetooth Low Energy (BLE) demonstration applications</h2>
<ul>
<li>
The following BLE examples applications are available with related workspaces and BLE stack v2.1 modular configurations options for BLE_STACK_CONFIGURATION: <ol>
<li>
<b>BLE ANCS </b> application supporting the notification consumer profile role: <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspace: Release [BLE_STACK_BASIC_CONFIGURATION]).</li>
</ul>
</li>
<li>
<b>BLE Beacon </b> application: <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspaces: Release [BLE_STACK_BASIC_CONFIGURATION], Use_OTA_ServiceManager [BLE_STACK_BASIC_CONFIGURATION]).</li>
</ul>
</li>
<li>
<b>BLE Beacon with Flash Management</b> application: <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspaces: Release [BLE_STACK_BASIC_CONFIGURATION]).</li>
</ul>
</li>
<li>
<b>BLE Chat </b> application: <ul>
<li>
Projects supporting BlueNRG-1 Development Kits (workspaces: Client [BLE_STACK_FULL_CONFIGURATION], Server [BLE_STACK_BASIC_CONFIGURATION], Server Lower &amp; Higher with OTA [BlueNRG-1: BLE_STACK_BASIC_CONFIGURATION], BlueNRG-2: BLE_OTA_BASIC_CONFIGURATION], Server with OTA Service Manager [BLE_STACK_BASIC_CONFIGURATION]).</li>
</ul>
</li>
<li>
<b>BLE Chat Master &amp; Slave</b> application: <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspace: Release [BLE_STACK_FULL_CONFIGURATION]). </li>
</ul>
</li>
<li>
<b>BLE HID/HOGP Mouse and Keyboard</b> applications: <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspaces: HID_Keyboard [BLE_STACK_BASIC_CONFIGURATION], HID_Mouse [BLE_STACK_BASIC_CONFIGURATION]). </li>
</ul>
</li>
<li>
<b>BLE OTA Reset Manager </b> applications: <ul>
<li>
Projects supporting BlueNRG-1 Development Kits (workspaces: Release [BLE_STACK_BASIC_CONFIGURATION], Service Manager [BlueNRG-1: BLE_STACK_BASIC_CONFIGURATION], BlueNRG-2: BLE_OTA_BASIC_CONFIGURATION]).</li>
</ul>
</li>
<li>
<b>BLE Master and Slave with Formula </b> applications: <ul>
<li>
Projects supporting BlueNRG-1 Development Kits (workspaces: Master_Slave [BLE_STACK_FULL_CONFIGURATION], Master [BLE_STACK_FULL_CONFIGURATION]).</li>
</ul>
</li>
<li>
<b>BLE Power Consumption </b>example: <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspaces: Release [BLE_STACK_BASIC_CONFIGURATION]).</li>
</ul>
</li>
<li>
<b>BLE Remote Control </b>example: <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspaces: Release [BLE_STACK_FULL_CONFIGURATION]).</li>
</ul>
</li>
<li>
<b>BLE Sensor Demo </b>application with acceleration and environmental sensors values (temperature &amp; pressure): <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspaces: Release [BLE_STACK_BASIC_CONFIGURATION], Lower &amp; Higher with OTA [BlueNRG-1: BLE_STACK_BASIC_CONFIGURATION], BlueNRG-2: BLE_OTA_BASIC_CONFIGURATION], Use OTA Service Manager [BLE_STACK_BASIC_CONFIGURATION]).</li>
</ul>
</li>
<li>
<b>BLE Sensor Demo, BlueMS </b>application supporting ST BlueMS smarthphone app: <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspaces: Release [BLE_STACK_BASIC_CONFIGURATION]).</li>
</ul>
</li>
<li>
<b>BLE Sensor Demo with Fixed stack </b>application: <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspaces: Release).</li>
</ul>
</li>
<li>
<b>Fixed stack </b>project for generating the BLE fixed stack image: <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspaces: Release [BLE_STACK_FULL_CONFIGURATION]).</li>
</ul>
</li>
<li>
<b>BLE Sensor Demo Central </b> which emulates the Sensor Demo applications available for smartphones (IOS and Android): <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspace: Release [BLE_STACK_FULL_CONFIGURATION]</li>
</ul>
</li>
<li>
<b>BLE Security </b> which shows some basic security examples : <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits </li>
<li>
Workspaces &amp; supported combinations: <ul>
<li>
Master_PassKey_Random &amp; Slave_PassKey_Random [BLE_STACK_FULL_CONFIGURATION] </li>
<li>
Master_PassKey_Fixed &amp; Slave_PassKey_Fixed [BLE_STACK_FULL_CONFIGURATION] </li>
<li>
Master_JustWorks &amp; Slave_JustWorks [BLE_STACK_FULL_CONFIGURATION] </li>
<li>
Master_NumericComp &amp; Slave_NumericComp (new pairing method supported only with LE Secure connections: BLE v4.2 security) [BLE_STACK_FULL_CONFIGURATION] </li>
</ul>
</li>
</ul>
</li>
<li>
<b>BLE Throughput </b> application: <ul>
<li>
Projects supporting BlueNRG-1_2 Development Kits (workspaces: Client [BLE_STACK_FULL_CONFIGURATION] &amp; Server [BLE_STACK_BASIC_CONFIGURATION] unidirectional throughput, Client [BLE_STACK_FULL_CONFIGURATION] &amp; Server [BLE_STACK_BASIC_CONFIGURATION] bidirectional throughput).</li>
</ul>
</li>
<li>
<b>BLE Throughput with data length extension</b> application: <ul>
<li>
Projects supporting BlueNRG-2 with BLE stack v2.1 Development Kits (workspaces: Client [BLE_STACK_FULL_CONFIGURATION], Server [BLE_STACK_FULL_CONFIGURATION]).</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2><a class="anchor" id="S32"></a>
Bluetooth Low Energy (BLE) network coprocessor</h2>
<ul>
<li><b>DTM v3.0</b> application for network coprocessor mode (UART or SPI): <ul>
<li>
It supports network coprocessor configurations: UART (16MHz or 32MHz) and SPI. </li>
<li>
Projects supporting BlueNRG-1,2 Development Kits (workspaces: Release_SPI, Release_UART_16MHz, Release_UART_32MHz,Release_SPI_noboot,Release_UART_16MHz_noboot, Release_UART_32MHz_noboot). </li>
</ul>
</li>
</ul>
<ul>
<li><b>NOTES </b>: <ul>
<li>
<b> Before using a STEVAL-IDB007Vx (x = 1,2)/STEVAL-IDB008Vx (x = 1,2) platform as network coprocessor (UART or DTM), upgrade the DTM application to the latest available version (v3.0) </b>. <ul>
<li>
Prebuilt DTM binary images (DTM_SPI.hex, DTM_UART_16MHz.hex, DTM_UART_32MHz.hex) are available on Firmware//BLE_Examples/DTM folder and can be downloaded using the BlueNRG-1,2 Navigator tools or Flasher tool.</li>
</ul>
<ul>
<li>
The workspaces Release_SPI, Release_UART_16MHz, Release_UART_32MHz also include the bootloader/updater code which allows to upgrade the network coprocessor code with new FW versions using the BlueNRG GUI, Tools, BlueNRG Updater .... utility. </li>
<li>
The Release_SPI_noboot,Release_UART_16MHz_noboot, Release_UART_32MHz_noboot workspaces allow to build the DTM binary files to be used with the BlueNRG GUI, Tools, BlueNRG Updater .... utility provided the BlueNRG-1 kit is already configured as network coprocessor mode. </li>
<li>
<b> Release_UART_16MHz</b> is the network coprocessor UART configuration to be used for the <b> BlueNRG-1, STEVAL-IDB007Vx (x = 1,2)</b> platform (DIO8 pin for UART TX and DIO11 pin for UART RX). </li>
<li>
<b> Release_UART_32MHz</b> is the network coprocessor UART configuration to be used for the <b>BlueNRG-2, STEVAL-IDB008Vx (x = 1,2)</b> platform (DIO8 pin for UART TX and DIO11 pin for UART RX). </li>
<li>
When using the DTM SPI mode on a specific user platform, please make sure to select the proper High Speed Crystal (16MHz or 32MHz). </li>
<li>
The SPI network coprocessor configuration requires some HW changes on STEVAL-IDB007V1 platform if not already present (refer to the SPI protocol specification document which also describes the required BlueNRG-1 SPI lines). </li>
<li>
The BlueNRG GUI, Tools, BlueNRG Updater .... utility allows to upgrade only the Release_SPI_noboot,Release_UART_16MHz_noboot, Release_UART_32MHz_noboot DTM binary files. </li>
<li>
BlueNRG GUI PC application supporting BlueNRG-1 network coprocessor with updated DTM FW v2.1.0 is provided within the STSW-BNRGUI SW package v2.6.0. </li>
</ul>
</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="S33"></a>
Peripheral drivers examples</h2>
<ul>
<li>
<p class="startli">The following Peripherals Drivers examples are available: </p><ol>
<li>
<b>ADC </b>examples: <ol>
<li>
DMA </li>
<li>
PDM </li>
<li>
Polling </li>
</ol>
</li>
<li>
<b>GPIO </b>examples: <ol>
<li>
Input Interrupt </li>
<li>
IO Toggle </li>
<li>
IO Wakeup </li>
</ol>
</li>
<li>
<b> FLASH </b> example: <ol>
<li>
Data Storage </li>
</ol>
</li>
<li>
<b>I2C </b> examples:<ol>
<li>
Master Polling </li>
<li>
Master Sensor (Dma, Polling &amp; Interrupt) </li>
<li>
Slave Polling </li>
<li>
Master DMA </li>
<li>
Slave DMA </li>
</ol>
</li>
<li>
<b>MFT </b>examples: <ol>
<li>
Mode 1 </li>
<li>
Mode 1a </li>
<li>
Mode 2 </li>
<li>
Mode 3 </li>
<li>
Mode 4 </li>
</ol>
</li>
<li>
<b>Micro </b>examples: <ol>
<li>
Hello World </li>
<li>
Sleep test</li>
</ol>
</li>
<li>
<b>PKA </b>examples: <ol>
<li>
DataEncrypt</li>
</ol>
</li>
<li>
<b>2.4 GHZ proprietary radio </b>examples: <ol>
<li>
Automatic Channel Management </li>
<li>
Beep </li>
<li>
Beep multi state </li>
<li>
Chat </li>
<li>
Chat with Encryption </li>
<li>
Remote Control </li>
<li>
Sleep (TX, RX) </li>
<li>
Sniffer </li>
<li>
Sniffer multi state </li>
<li>
TX, RX </li>
<li>
TX, RX double packet </li>
<li>
Star network (master and slave roles) </li>
<li>
OTA Reset Manager with Client, Server configuration</li>
</ol>
</li>
<li>
<b> RNG </b> example: <ol>
<li>
Terminal </li>
</ol>
</li>
<li>
<b>RTC </b>examples: <ol>
<li>
Clock watch </li>
<li>
Time Base </li>
<li>
Time Base Pattern </li>
<li>
RTC with Virtual Timer</li>
</ol>
</li>
<li>
<b>SPI </b> examples:<ol>
<li>
Master Polling </li>
<li>
Master Sensor (Dma, Polling &amp; Interrupt) </li>
<li>
Slave Polling </li>
<li>
SPI 3 wires </li>
</ol>
</li>
<li>
<b>SysTick </b>examples: <ol>
<li>
Time Base</li>
</ol>
</li>
<li>
<b>UART </b>examples: <ol>
<li>
Dma </li>
<li>
Interrupt </li>
<li>
Polling </li>
<li>
RX Timeout</li>
</ol>
</li>
<li>
<b>WDG </b>examples: <ol>
<li>
Reset </li>
<li>
Wakeup</li>
</ol>
</li>
</ol>
<p class="endli"></p>
</li>
</ul>
<h1><a class="anchor" id="S4"></a>
Development Toolchains</h1>
<ul>
<li>
IAR Embedded Workbench for ARM (EWARM) toolchain V7.70.1 or later. </li>
<li>
NOTES: <ul>
<li>
On BlueNRG-1_2 DK, Utility folder, EWARM_BlueNRG-2_Flasher.exe utility allows to add BlueNRG-2 device support to EWARM, IAR toolchain </li>
</ul>
</li>
</ul>
<ul>
<li>
Keil uVision V5 (MDK-ARM) toolchain V5.17 </li>
<li>
NOTES: <ul>
<li>
For BlueNRG-1 device support, user is requested to install the official BlueNRG-1 Keil, MDK-ARM support files (Keil Pack version 1.2.0) and BlueNRG-2 Keil, MDK-ARM support files (Keil Pack version 1.0.0). Check on Keil web site for available BlueNRG-1, BlueNRG-2 Keil packs version. </li>
<li>
Before installing a new Keil pack, please remove the current used one. </li>
<li>
When opening a Keil project, please make sure the ST BlueNRG-1 or ST BlueNRG-2 has been already selected as device on Keil Debug tab as follow: <ul>
<li>
On Keil Project, Option for Target '...', Debug, Use tab, select ST-Link Debugger option; </li>
<li>
Open the associated Settings tab, select Flash Download and then Add button: select ST BlueNRG-1 or ST BlueNRG-2 Device Family Package according to the current selected device and press Add. </li>
<li>
The selected configuration can then be saved from File, Save All option (on file *.uvoptx). </li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>
Atollic TrueStudio for ARM (GCC) toolchain <b><a href="https://atollic.com/release-news/atollic-truestudio-8-1-0-released/">V8.1.0 </a></b> which supports both BlueNRG-1 and BlueNRG-2 devices. </li>
<li>
NOTES: <ul>
<li>
When opening the Atollic project, in order to select the ST-LINK debugger and save it on local user Atollic workspace (Atollic preferences storage area), follow these steps:<ul>
<li>
Select the specific Atollic Active configuration and rebuild the project </li>
<li>
From Project, Build/Settings: Run/Debug Settings: New: <ul>
<li>
On Main tab: C\C++ Application: click on Search Project and select the elf file (i.e. Release\Release.elf) </li>
<li>
On Build Configuration tab select the specific workspace name (i.e: Release) </li>
<li>
On Debugger tab: Debug Probe, select ST-LINK </li>
</ul>
</li>
</ul>
</li>
<li>
When opening an Atollic project, please double check if the target MCU is correctly selected as follow:<ul>
<li>
From Project, Build/Settings: C/C++ Build, Settings, select Target Settings: <ul>
<li>
On Target, Device select STMicroelectronics, MCUs, BlueNRG-1 devices or BlueNRG-2 devices and, respectively, BlueNRG-132 or BlueNRG-232 </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="S5"></a>
Supported platforms</h1>
<ul>
<li>
BlueNRG-1, STEVAL-IDB007V1 development kit (order code: STEVAL-IDB007V1).  </li>
<li>
BlueNRG-1, STEVAL-IDB007V2 development kit (order code: STEVAL-IDB007V2).  </li>
<li>
BlueNRG-2, STEVAL-IDB008V1 development kit (order code: STEVAL-IDB008V1).  </li>
<li>
BlueNRG-2, STEVAL-IDB008V2 development kit (order code: STEVAL-IDB008V2).  </li>
<li>
NUCLEO-L152RE platform + BlueNRG-1/STEVAL-IDB007Vx (x=1,2) or BlueNRG-2/STEVAL-IDB002Vx (x=1,2) configured as DTM network coprocessor (SPI mode).</li>
</ul>
<ul>
<li>NOTES: <ol>
<li>
When using a NUCLEO-L152RE platform, install the related ST-Link, ST-Link/V2, ST-Link/V2-1 USB driver (STSW-LINK009). </li>
<li>
When using a NUCLEO-L152RE platform, make sure the ST-Link firmware is updated to latest version available on ST web page. This can be checked/achieved by using the STM32 ST-LINK Utility v3.6.0 (or later): <ol>
<li>
Connect a NUCLEO-L152RE platform to a PC USB port </li>
<li>
Download and install STM32 ST-LINK Utility v3.6.0 (or later): it is available on ST web site (STSW-LINK004). </li>
<li>
Run the STM32 ST-LINK Utility v3.6.0 (or later). </li>
<li>
From Target menu, select Connect </li>
<li>
From ST-LINK menu, select Firmware Upgrade and Device Connect. Click on Yes &gt;&gt;&gt; tab for performing the ST-LINK firmware upgrade.</li>
</ol>
</li>
</ol>
</li>
</ul>
<h1><a class="anchor" id="S6"></a>
Known problems and limitations</h1>
<p>This section lists the issues known at release time. Issues found after this release are listed as solved or limitations on newer releases:<br />
</p>
<ul>
<li>ID 2411 ADC issue on accessing ADC APB registers when device is clocked with the 32 MHz: <ul>
<li>
SW workaround has been applied on files BlueNRG1_adc.[c/h] (under preprocessor option: ADC_2411=1 to be added by user on his application) </li>
</ul>
</li>
<li>ID 2488 BlueNRG-1 device is not supported on Atollic release v9.x: <ul>
<li>
<a href="https://atollic.com/release-news/atollic-truestudio-8-1-0-released/">Atollic v8.1.0 </a> supporting BlueNRG-1, BlueNRG-2 devices is available on Atollic web site</li>
</ul>
</li>
<li>ID 3077 Controller Privacy 1.2 is not supported when using a 16MHz crystal. </li>
<li>ID 2070 STEVAL-IDB007Vx (x = 1,2),STEVAL-IDB008Vx (x = 1,2) development kits max output power is +6dBm. </li>
<li>ID 2071 OTA framework is not supported when using Atollic, TrueStudio toolchain </li>
<li>ID 2089 If the DL2 led (BOOT pin) is high before the BlueNRG-1,2 goes to sleep, the pin level stays high (~2 V with 3.3 V of VDD). </li>
<li>ID 2524 SPI protocol - First byte of header. </li>
<li>ID 2639 Hardware Activation of DTM Updater (v1.7 or later, SPI mode) has been disabled. </li>
<li>ID 2384 DTM no boot image </li>
<li>ID 2524 SPI protocol - First byte of header </li>
<li>ID 3142 BlueNRG-2 GPIO9, GPIO10 and GPIO11 wrong setting in retention mode (output mode 0 and not 1)</li>
</ul>
<h1><a class="anchor" id="S7"></a>
Virtual COM driver installation: manual procedure</h1>
<ul>
<li>During the BlueNRG-1_2 DK Development kits (STSW-BLUENRG1-DK) SW package installation procedure, the PC Virtual COM driver installation is also automatically started, in order to properly recognize STEVAL-IDB007Vx, STEVAL-IDB008Vx platforms. </li>
<li>If the automatic PC Virtual COM driver installation procedure fails, in order to properly recognize a plugged STEVAL-IDB007Vx, STEVAL-IDB008Vx platform, user should manually install the driver by following this procedure: <ol>
<li>
Go to PC, Windows Device Manager. </li>
<li>
Look for "Other devices" tab: on the available reported device, related to the not recognized STEVAL-IDB007Vx, STEVAL-IDB008Vx device (label: Unknown Device or STMicrolectronics). </li>
<li>
Right click on mouse and select <b>Update Driver Software</b> option. </li>
<li>
<b>Browse to BlueNRG-1_2 DK Development kits installation folder </b>(default path is C: Files (x86)-1_2 DK x.x.x) and select PCDriver\Virtual COM Port Driver and proceed with "Next" button. </li>
<li>
If asked, allow the driver installation by selecting: "Install this driver software anyway" option. </li>
<li>
Driver installation is completed and STEVAL-IDB007Vx, STEVAL-IDB008Vx platforms are correctly recognized and reported on Device Manager, Ports (COM &amp; LPT) tab, with associated COM port number.</li>
</ol>
</li>
</ul>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2021 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
